(self["webpackChunkdocx"]=self["webpackChunkdocx"]||[]).push([[907],{5122:(t,e,o)=>{"use strict";o.d(e,{Z:()=>r});class l{toLocalString(t){return new Date(t||"").toLocaleString()}}const a=new l,r=a},9922:(t,e,o)=>{"use strict";o.d(e,{Z:()=>u});var l=o(6892),a=o.n(l),r=o(6490);const s={getFilenameFromHeaders(t){let e="";const o=t["Content-Disposition"]||t["content-disposition"];if(o&&-1!==o.indexOf("attachment")){const t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,l=t.exec(o);null!=l&&l[1]&&(e=l[1].replace(/['"]/g,""))}return e.startsWith("UTF-8")&&(e=e.substring(5),e=decodeURIComponent(e)),e}};var n=o(4259),d=function(t,e,o,l){function a(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{d(l.next(t))}catch(e){r(e)}}function n(t){try{d(l["throw"](t))}catch(e){r(e)}}function d(t){t.done?o(t.value):a(t.value).then(s,n)}d((l=l.apply(t,e||[])).next())}))};class i{downloadReportById(t){return d(this,void 0,void 0,(function*(){if(t){const e=yield r.restApi.downloadReport(t);let o=s.getFilenameFromHeaders(e.headers);o||(o=`report_${(0,n.Z)()}.docx`),a()(e.data,o)}}))}downloadScoreListById(t){return d(this,void 0,void 0,(function*(){if(t){const e=yield r.restApi.downloadScoreList(t);let o=s.getFilenameFromHeaders(e.headers);o||(o=`score_list_${(0,n.Z)()}.docx`),a()(e.data,o)}}))}}const c=new i,u=c},1907:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>st});var l=o(3673);function a(t,e,o,a,r,s){const n=(0,l.up)("follower-reports-table-grid"),d=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(d,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(n)])),_:1})}var r=o(2323),s=o(1813),n=o.n(s);const d={class:"q-pa-md row items-start q-gutter-md"},i={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},c={class:"row items-center no-wrap"},u={class:"col"},m={class:"text-h6"},p={class:"text-subtitle2"},w={class:"text-subtitle2"},f=(0,l.Uk)("Статус: "),g={class:"text-subtitle2"},W=(0,l.Uk)(" Дата создания : "),h={class:"col-auto"},_=(0,l.Uk)("Удалить"),b=(0,l.Uk)("Изменить статус"),v=(0,l.Uk)("Редактировать"),Z=(0,l.Uk)("Скачать отчет"),k=(0,l.Uk)("Скачать оценочный лист"),q={class:"full-width row flex-center text-accent q-gutter-sm text-h6"},C={class:"text-h6"},S={class:"row q-gutter-md q-ma-md"};function y(t,e,o,a,s,y){const x=(0,l.up)("q-icon"),R=(0,l.up)("q-input"),F=(0,l.up)("q-separator"),U=(0,l.up)("q-badge"),Q=(0,l.up)("q-item-section"),I=(0,l.up)("q-item"),B=(0,l.up)("q-list"),D=(0,l.up)("q-menu"),H=(0,l.up)("q-btn"),L=(0,l.up)("q-card-section"),E=(0,l.up)("q-card"),V=(0,l.up)("q-img"),z=(0,l.up)("q-table"),A=(0,l.up)("q-select"),P=(0,l.up)("q-card-actions"),T=(0,l.up)("q-form"),N=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)("div",d,[(0,l.Wm)(z,{grid:"",title:"Отчеты учителей из моей группы",rows:t.reports,"grid-header":"",columns:t.columns,class:"full-width","no-data-label":"у нас нет отчетов","no-results-label":"мы ничего не нашли","row-key":"id",filter:t.filter},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(R,{borderless:"",dense:"",debounce:"300",modelValue:t.filter,"onUpdate:modelValue":e[1]||(e[1]=e=>t.filter=e),placeholder:"Поиск",style:{"min-width":"250px"}},{append:(0,l.w5)((()=>[(0,l.Wm)(x,{name:"search"})])),_:1},8,["modelValue"])])),item:(0,l.w5)((e=>[(0,l.Wm)("div",i,[(0,l.Wm)(E,{class:"report_card_table_item bg-secondary",flat:"",bordered:""},{default:(0,l.w5)((()=>[(0,l.Wm)(L,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",c,[(0,l.Wm)("div",u,[(0,l.Wm)("div",m,"Название: "+(0,r.zw)(e.row.reportName),1),(0,l.Wm)(F,{class:"q-my-sm"}),(0,l.Wm)("div",p,"Автор: "+(0,r.zw)(t.userUtils.getShortFio(e.row.author)),1),(0,l.Wm)("div",w,[f,(0,l.Wm)(U,{color:t.getColorByStatus(e.row.status)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.row.status),1)])),_:2},1032,["color"])]),(0,l.Wm)("div",g,[W,(0,l.Wm)("b",null,(0,r.zw)(t.dateUtils.toLocalString(e.row.createdDate)),1)])]),(0,l.Wm)("div",h,[(0,l.Wm)(H,{color:"grey-7",round:"",flat:"",icon:"more_vert"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{cover:"","auto-close":""},{default:(0,l.w5)((()=>[(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{clickable:"",onClick:o=>t.deleteReportHandler(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[_])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(I,{clickable:"",onClick:o=>t.toggleEditStatusDialog(e.row)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[b])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(I,{clickable:"",onClick:o=>t.editReport(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[v])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(I,{clickable:"",onClick:o=>t.downloadReport(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[Z])),_:1})])),_:2},1032,["onClick"]),(0,l.Wm)(I,{clickable:"",onClick:o=>t.downloadScoreList(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[k])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])])])),_:2},1024)])),_:2},1024)])])),"no-data":(0,l.w5)((({message:t})=>[(0,l.Wm)("div",q,[(0,l.Wm)(V,{src:n(),style:{width:"64px",height:"64px"}}),(0,l.Wm)("span",null,[(0,l.Wm)("b",null,"Так ужасно что ... "+(0,r.zw)(t),1)])])])),_:1},8,["rows","columns","filter"]),(0,l.Wm)(N,{modelValue:t.status_dialog,"onUpdate:modelValue":e[3]||(e[3]=e=>t.status_dialog=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(E,{class:"bg-secondary my-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(T,{onSubmit:t.updateFollowerReportStatus},{default:(0,l.w5)((()=>[(0,l.Wm)(L,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",C,"Изменить статус отчета: "+(0,r.zw)(t.edited_report.reportName),1)])),_:1}),(0,l.Wm)(L,{class:""},{default:(0,l.w5)((()=>[(0,l.Wm)("div",S,[(0,l.Wm)(A,{class:"col-12",modelValue:t.edited_report.status,"onUpdate:modelValue":e[2]||(e[2]=e=>t.edited_report.status=e),options:["COMPLETED","CHECKED","UNCHECKED"]},null,8,["modelValue"])])])),_:1}),(0,l.Wm)(P,{align:"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{flat:"",label:"Изменить",color:"accent",type:"submit"})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"])])}var x=o(1959),R=o(9922),F=o(222),U=o(5122),Q=o(1515),I=o(703),B=o(2925),D=o(3406),H=o(9582);const L=(0,l.aZ)({name:"FollowerReportTableGrid",setup(){const t=(0,B.useStore)(),e=(0,H.tv)(),o=(0,l.Fl)((()=>t.getters["report/getFollowerReports"])),a=(0,l.Fl)((()=>t.getters["report/getColumns"])),r=(0,x.qj)({}),s=t.getters["report/getColorByStatus"],n=(0,x.iH)(!1),d=(0,x.iH)(""),i=(0,x.iH)(!1);function c(t){R.Z.downloadReportById(t)}function u(t){R.Z.downloadScoreListById(t)}function m(){t.dispatch("report/editReportStatus",r).then((t=>{t&&D.Z.showPositive("Статус успешно изменен")})).finally((()=>n.value=!1))}function p(t){n.value=!n.value,r.id=t.id,r.reportName=t.reportName,r.status=t.status}function w(o){t.dispatch("report/fetchReportByIdAndSetTablesData",o).then((t=>{t&&e.push("createReport")}))}function f(e){confirm("Вы подтверждаете удаление?")&&t.dispatch("report/deleteReportById",e).then((t=>{t&&D.Z.showPositive("Успешно удалено")}))}return{deleteReportHandler:f,filter:d,reports:o,columns:a,dateUtils:U.Z,userUtils:Q.Z,reportUtils:I.Z,expanded:i,EReportStatus:F.d,getColorByStatus:s,downloadReport:c,downloadScoreList:u,status_dialog:n,toggleEditStatusDialog:p,edited_report:r,updateFollowerReportStatus:m,editReport:w}}});var E=o(6429),V=o(4842),z=o(4554),A=o(151),P=o(5589),T=o(5869),N=o(9721),j=o(8240),G=o(6335),K=o(7011),M=o(3414),O=o(2035),$=o(4027),J=o(6778),X=o(5269),Y=o(8516),tt=o(9367),et=o(7518),ot=o.n(et);L.render=y;const lt=L;ot()(L,"components",{QTable:E.Z,QInput:V.Z,QIcon:z.Z,QCard:A.Z,QCardSection:P.Z,QSeparator:T.Z,QBadge:N.Z,QBtn:j.Z,QMenu:G.Z,QList:K.Z,QItem:M.Z,QItemSection:O.Z,QImg:$.Z,QDialog:J.Z,QForm:X.Z,QSelect:Y.Z,QCardActions:tt.Z});const at=(0,l.aZ)({name:"FollowerReportsPage",components:{FollowerReportsTableGrid:lt},setup(){const t=(0,B.useStore)();async function e(){Q.Z.isCurrentUserAdmin()?await t.dispatch("report/fetchAllFollowerReports"):await t.dispatch("report/fetchFollowerReports")}return(0,l.bv)(e),{}}});var rt=o(4379);at.render=a;const st=at;ot()(at,"components",{QPage:rt.Z})},1813:(t,e,o)=>{t.exports=o.p+"img/notFoundData.f41aaad2.gif"}}]);